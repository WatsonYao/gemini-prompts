# Android Prompts 应用

一个基于Gemini API的Android应用，用于对多个prompt进行轮询请求并展示结果。

## 功能特点

- 🤖 支持多种Gemini模型（pro/flash/flash-lite）
- 📝 批量prompt轮询处理
- 🗂️ JSON文件导入prompt分类
- 📱 Material Design暗色主题
- 📊 实时通知和进度显示
- 💾 历史记录保存和查看
- ⏱️ 请求计时和倒计时功能

## 使用前准备

### 1. 获取Gemini API Key
1. 访问 [Google AI Studio](https://aistudio.google.com/)
2. 登录Google账户
3. 创建新的API Key
4. 复制API Key备用

### 2. 网络要求
- 需要稳定的网络连接
- 如果在中国大陆，需要开启VPN访问Google服务

## 使用步骤

### 第一步：设置API Key
1. 打开应用
2. 点击顶部右上角的**设置**按钮（齿轮图标）
3. 在弹出的设置页面中：
   - 输入你的Gemini API Key
   - 选择想要使用的模型：
     - `gemini-2.5-pro`：高性能模型，响应质量最高
     - `gemini-2.5-flash`：默认选择，平衡性能和速度
     - `gemini-2.5-flash-lite`：轻量级模型，响应最快
4. 点击**保存**按钮

### 第二步：导入Prompt分类
1. 在设置页面点击**导入JSON**按钮
2. 选择包含prompt分类的JSON文件
3. 等待导入完成提示

#### JSON文件格式示例：
```json
[
    {
        "历史": [
            "=== 通鉴镜 ===\n=== 历史分析专家 ===",
            "=== 通鉴镜 ===\n=== 历史分析专家2 ==="
        ]
    },
    {
        "读书": [
            "=== 书境探索者 ===\n=== 阅读指导专家 ==="
        ]
    },
    {
        "思考": [
            "=== 知识向导 ===\n=== 思维启发专家 ==="
        ]
    },
    {
        "小说": [
            "=== 吓自己 ===\n=== 恐怖小说创作者 ===",
            "=== 本格推理 ===\n=== 悬疑推理小说创作者 ==="
        ]
    }
]
```

### 第三步：开始轮询
1. 点击左上角**菜单**图标打开侧边栏
2. 在上半部分的文本框中输入你的问题
3. 在下半部分选择一个prompt分类（单选）
4. 点击底部的**发送**按钮开始轮询

### 第四步：查看结果
1. 轮询开始后，应用会：
   - 关闭侧边栏
   - 在通知栏显示实时进度
   - 按钮文字变为"停止"
   - 在主界面的ViewPager中逐个显示响应结果

2. 通知栏会显示：
   - 请求状态：`请求中(当前/总数) [prompt名称] - X秒`
   - 等待状态：`等待下一个请求 - X秒 | 分类: [分类名]`
   - 完成状态：`轮询完成 已完成所有X个prompt的轮询`

### 第五步：查看历史记录
1. 点击顶部右上角的**历史**按钮
2. 在历史记录列表中：
   - 查看所有历史对话（按时间倒序）
   - 点击任意记录查看详细内容
   - 点击**清空历史**删除所有记录
   - 点击**关闭**退出历史页面

## 界面说明

### 主界面
- **顶部工具栏**：包含菜单、标题、历史和设置按钮
- **主要区域**：ViewPager显示API响应结果，支持左右滑动
- **侧边栏**：
  - 上半部分：多行文本输入框
  - 下半部分：prompt分类选择（支持滚动）
  - 底部：发送按钮

### 通知系统
- 应用启动时显示状态通知
- 轮询过程中实时更新进度
- 显示请求正计时和间隔倒计时
- 完成后显示最终结果

## 注意事项

### 轮询规则
- 每个分类下的所有prompt只轮询**一遍**
- 请求失败时**不会重试**，直接继续下一个
- 每次请求完成后等待**1分钟**再发送下一个
- 可随时点击"停止"按钮中断轮询

### 网络超时
- 所有网络请求超时时间为**1分钟**
- 包括连接、读取、写入超时

### 数据存储
- API Key和设置信息保存在本地
- 所有对话历史保存在Room数据库
- 导入的prompt分类保存在SharedPreferences

### 系统要求
- Android 6.0 (API 23) 及以上
- 网络访问权限
- 通知权限（Android 13+需要手动授权）

## 故障排除

### 常见问题
1. **网络请求失败**
   - 检查网络连接
   - 确认VPN已开启（如需要）
   - 验证API Key是否正确

2. **通知不显示**
   - 检查应用通知权限
   - Android 13+需要手动授权通知权限

3. **轮询未开始**
   - 确认已输入问题文本
   - 确认已选择prompt分类
   - 确认已设置API Key
   - 确认已导入JSON文件

4. **JSON导入失败**
   - 检查JSON格式是否正确
   - 确认文件编码为UTF-8

### 技术支持
如遇到问题，请检查：
1. Logcat输出中的错误信息
2. 网络连接状态
3. API Key有效性
4. JSON文件格式

## 开源信息

本项目基于以下技术栈：
- **语言**：Kotlin
- **UI框架**：传统Android View系统 + Material Design
- **网络请求**：Retrofit2 + OkHttp
- **数据库**：Room
- **异步处理**：Kotlin Coroutines
- **主题**：Material3 暗色主题

## 版本信息

当前版本支持的Gemini模型：
- gemini-2.5-pro
- gemini-2.5-flash  
- gemini-2.5-flash-lite

---

**享受使用Android Prompts应用进行AI对话吧！** 🚀
